---
tags:
상태:
중요:
생성일: 26-02-03T16:34:09
수정일: 26-02-03T16:41:18
종료일:
라벨:
summary:
---
## 0. 참고 레퍼런스
- 
##  ■■ Description ■■
- 
## 1. 애니메이션 구현 방식: **복합 트랜스포메이션 (Combined Transformation)**
- 나사를 푸는 동작은 단순히 위치를 옮기는 것이 아니라, **회전(Rotation)** 과 **이동(Translation)** 이 동시에 정비례하게 일어나도록 구현해야 한다.
- **사용 라이브러리 추천:** 
    - `GSAP` (GreenSock Animation Platform) 또는 React Three Fiber의 `useFrame`.
    - **GSAP 추천 이유:** 
        - "나사를 3바퀴 돌리면서 2cm 뒤로 뺀다"와 같은 타임라인 기반의 정밀한 제어가 쉽습니다.
- **핵심 원리:** 나사의 나사산(Pitch)에 맞춰 회전량에 따른 이동 거리를 계산 한다.
    $$이동 거리 = \frac{회전 각도}{360^\circ} \times 나사산 간격(Pitch)$$
## 2. 기능 구현 순서
- 
### 2-1. 제안 방식
1. **회전 애니메이션**: 나사를 회전축(일반적으로 Z축)을 기준으로 회전
2. **이동 애니메이션**: 회전하면서 Z축 방향으로 빼냄
3. **동시 실행**: 회전과 이동을 동시에 수행하여 자연스러운 "돌려서 빼는" 효과
### 2-2. 기술적 구현
- Three.js의 `rotation.z`, `position.z`를 동시에 업데이트
- `requestAnimationFrame`을 사용하여 부드러운 애니메이션
- Easing 함수 적용 (현재 `1 - Math.pow(1 - t, 3)` 사용)
## 3. 구현 순서
### 1단계: 회전 애니메이션 함수 추가
- `animateRotation()` 함수 구현
- 회전 시작각도, 종료각도, 지속시간 파라미터
- 기존 `animateLocalPosition()`과 유사한 구조
### 2단계: 회전+이동 동시 애니메이션 함수 추가
- `animateRotationAndTranslation()` 함수 구현
- 회전과 이동을 동시에 수행
- easing 함수 적용
### 3단계: Screw 노드 감지 로직 추가
- `isFastener()` 함수가 이미 존재 (`/screw|bolt/i.test()`)
- Screw 노드에 대해 회전 애니메이션 적용 조건 추가
### 4단계: handleLoosen 함수 수정
- Screw 노드인지 확인
- Screw일 경우: 회전+이동 애니메이션 사용
- 일반 노드일 경우: 기존 이동 애니메이션 사용
### 5단계: 테스트 및 검증
- Screw 노드 선택 후 "Pull Out" 버튼 클릭
- 회전하면서 빠지는지 확인
- 일반 노드는 기존대로 동작하는지 확인
## 4. 주요 수정 파일


## 추가 고려사항
- **회전 방향:** 시계 방향 또는 반시계 방향 결정 필요
- **회전 속도:** 나사 크기에 따라 조절 가능
- **회전 각도:** 완전히 빼질 때까지 회전 (예: 720도 = 2바퀴)
- **복수 Screw 처리:** 여러 Screw가 있는 경우 순차적 처리